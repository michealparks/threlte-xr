import{F as se,s as G,B as D,C as E,z as ee,D as fe,r as le,a as w,e as B,c as x,i as y,u as oe,v as $e,w as ue,d as k,p as me,G as ce,y as W,I as ge}from"../chunks/scheduler.d099de3d.js";import{S as M,i as H,b as c,d as g,m as p,a as $,t as u,e as _,g as F,c as J,f as pe}from"../chunks/index.5391bafe.js";import{i as _e,j as de,T as j,g as he,a as be,V as X,G as ye,b as te,X as ke,H as we,e as xe}from"../chunks/xr.47a50f20.js";import{B as ve}from"../chunks/button-vr.a4f2e173.js";import{b as Be,R as ne,C as re,I as je,a as Ie,u as Te,W as Ce,D as Re}from"../chunks/Instance.a365a406.js";import{e as N,u as Se,o as Ge}from"../chunks/each.f8e9f536.js";import"../chunks/PositionMesh.b481e9d5.js";const Me=(l,n,a)=>{const t=de(l);let i;const e=()=>{var s;const r=(s=t.current)==null?void 0:s.hand.joints[n];if((r==null?void 0:r.jointRadius)===void 0){i=setTimeout(e,100);return}a(r)};return e(),()=>clearTimeout(i)},He=(l,n)=>{const a=_e(void 0),t=Me(l,n,i=>a.set(i));return se(()=>t()),a},ze=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],Ve=l=>({ref:l&16384}),K=l=>({ref:l[14]});function O(l){let n,a;return n=new j.Mesh({props:{$$slots:{default:[Xe]},$$scope:{ctx:l}}}),{c(){c(n.$$.fragment)},l(t){g(n.$$.fragment,t)},m(t,i){p(n,t,i),a=!0},p(t,i){const e={};i&513&&(e.$$scope={dirty:i,ctx:t}),n.$set(e)},i(t){a||($(n.$$.fragment,t),a=!0)},o(t){u(n.$$.fragment,t),a=!1},d(t){_(n,t)}}}function Xe(l){let n,a,t,i;return n=new j.SphereGeometry({props:{args:[l[0]]}}),t=new j.MeshBasicMaterial({props:{wireframe:!0,transparent:!0,opacity:.25}}),{c(){c(n.$$.fragment),a=w(),c(t.$$.fragment)},l(e){g(n.$$.fragment,e),a=x(e),g(t.$$.fragment,e)},m(e,r){p(n,e,r),y(e,a,r),p(t,e,r),i=!0},p(e,r){const s={};r&1&&(s.args=[e[0]]),n.$set(s)},i(e){i||($(n.$$.fragment,e),$(t.$$.fragment,e),i=!0)},o(e){u(n.$$.fragment,e),u(t.$$.fragment,e),i=!1},d(e){e&&k(a),_(n,e),_(t,e)}}}function De(l){let n,a,t;const i=l[8].default,e=le(i,l,l[9],K);let r=l[1]&&O(l);return{c(){e&&e.c(),n=w(),r&&r.c(),a=B()},l(s){e&&e.l(s),n=x(s),r&&r.l(s),a=B()},m(s,m){e&&e.m(s,m),y(s,n,m),r&&r.m(s,m),y(s,a,m),t=!0},p(s,m){e&&e.p&&(!t||m&16896)&&oe(e,i,s,s[9],t?ue(i,s[9],m,Ve):$e(s[9]),K),s[1]?r?(r.p(s,m),m&2&&$(r,1)):(r=O(s),r.c(),$(r,1),r.m(a.parentNode,a)):r&&(F(),u(r,1,1,()=>{r=null}),J())},i(s){t||($(e,s),$(r),t=!0)},o(s){u(e,s),u(r),t=!1},d(s){s&&(k(n),k(a)),e&&e.d(s),r&&r.d(s)}}}function Ne(l){let n,a;const t=[{is:l[3]},l[4]];let i={$$slots:{default:[De,({ref:e})=>({14:e}),({ref:e})=>e?16384:0]},$$scope:{ctx:l}};for(let e=0;e<t.length;e+=1)i=D(i,t[e]);return n=new j({props:i}),{c(){c(n.$$.fragment)},l(e){g(n.$$.fragment,e)},m(e,r){p(n,e,r),a=!0},p(e,[r]){const s=r&24?he(t,[r&8&&{is:e[3]},r&16&&be(e[4])]):{};r&16899&&(s.$$scope={dirty:r,ctx:e}),n.$set(s)},i(e){a||($(n.$$.fragment,e),a=!0)},o(e){u(n.$$.fragment,e),a=!1},d(e){_(n,e)}}}function Pe(l,n,a){const t=["strength","range","gravityType","gravitationalConstant"];let i=E(n,t),e,{$$slots:r={},$$scope:s}=n,{strength:m=1}=n,{range:h=50}=n,{gravityType:b="static"}=n,{gravitationalConstant:f=6673e-14}=n;const{world:o,debug:v}=Be();ee(l,v,d=>a(1,e=d));const V=new X;let A=new ye;const ae={static:(d,I,R,T,S)=>d,linear:(d,I,R,T,S)=>d*(T/R),newtonian:(d,I,R,T,S)=>S*d*I/Math.pow(T,2)};function ie(){const d=new X;A.getWorldPosition(V),o.forEachRigidBody(I=>{const{x:R,y:T,z:S}=I.translation(),L=new X(R,T,S),q=V.distanceTo(L);if(q<h){let z=ae[b](m,I.mass(),h,q,f);z=z===1/0?m:z,d.subVectors(V,L).normalize().multiplyScalar(z),I.applyImpulse(d,!0)}})}return te(()=>{ie()}),l.$$set=d=>{n=D(D({},n),fe(d)),a(4,i=E(n,t)),"strength"in d&&a(5,m=d.strength),"range"in d&&a(0,h=d.range),"gravityType"in d&&a(6,b=d.gravityType),"gravitationalConstant"in d&&a(7,f=d.gravitationalConstant),"$$scope"in d&&a(9,s=d.$$scope)},[h,e,v,A,i,m,b,f,r,s]}class We extends M{constructor(n){super(),H(this,n,Pe,Ne,G,{strength:5,range:0,gravityType:6,gravitationalConstant:7})}}function Fe(l){let n,a;return n=new re({props:{shape:"ball",args:[l[1]]}}),{c(){c(n.$$.fragment)},l(t){g(n.$$.fragment,t)},m(t,i){p(n,t,i),a=!0},p(t,i){const e={};i&2&&(e.args=[t[1]]),n.$set(e)},i(t){a||($(n.$$.fragment,t),a=!0)},o(t){u(n.$$.fragment,t),a=!1},d(t){_(n,t)}}}function Je(l){let n,a,t;function i(r){l[4](r)}let e={type:"kinematicPosition",$$slots:{default:[Fe]},$$scope:{ctx:l}};return l[0]!==void 0&&(e.rigidBody=l[0]),n=new ne({props:e}),me.push(()=>pe(n,"rigidBody",i)),{c(){c(n.$$.fragment)},l(r){g(n.$$.fragment,r)},m(r,s){p(n,r,s),t=!0},p(r,[s]){const m={};s&66&&(m.$$scope={dirty:s,ctx:r}),!a&&s&1&&(a=!0,m.rigidBody=r[0],ce(()=>a=!1)),n.$set(m)},i(r){t||($(n.$$.fragment,r),t=!0)},o(r){u(n.$$.fragment,r),t=!1},d(r){_(n,r)}}}function Ae(l,n,a){var h;let t,{jointIndex:i}=n,{hand:e}=n,r;const s=He(e,ze[i]);te(()=>{if(s.current===void 0||r===void 0)return;const{x:b,y:f,z:o}=s.current.position;r.setNextKinematicTranslation({x:b,y:f,z:o})});function m(b){r=b,a(0,r)}return l.$$set=b=>{"jointIndex"in b&&a(2,i=b.jointIndex),"hand"in b&&a(3,e=b.hand)},a(1,t=((h=s.current)==null?void 0:h.jointRadius)??1e-4),[r,t,i,e,m]}class Q extends M{constructor(n){super(),H(this,n,Ae,Je,G,{jointIndex:2,hand:3})}}function U(l,n,a){const t=l.slice();return t[0]=n[a],t[2]=a,t}function Le(l){let n,a,t,i,e;return n=new re({props:{shape:"cuboid",args:[C/2,C/2,C/2]}}),t=new Ie({props:{color:"hotpink"}}),{c(){c(n.$$.fragment),a=w(),c(t.$$.fragment),i=w()},l(r){g(n.$$.fragment,r),a=x(r),g(t.$$.fragment,r),i=x(r)},m(r,s){p(n,r,s),y(r,a,s),p(t,r,s),y(r,i,s),e=!0},p:W,i(r){e||($(n.$$.fragment,r),$(t.$$.fragment,r),e=!0)},o(r){u(n.$$.fragment,r),u(t.$$.fragment,r),e=!1},d(r){r&&(k(a),k(i)),_(n,r),_(t,r)}}}function Y(l,n){let a,t,i;return t=new ne({props:{$$slots:{default:[Le]},$$scope:{ctx:n}}}),{key:l,first:null,c(){a=B(),c(t.$$.fragment),this.h()},l(e){a=B(),g(t.$$.fragment,e),this.h()},h(){this.first=a},m(e,r){y(e,a,r),p(t,e,r),i=!0},p(e,r){n=e;const s={};r&8&&(s.$$scope={dirty:r,ctx:n}),t.$set(s)},i(e){i||($(t.$$.fragment,e),i=!0)},o(e){u(t.$$.fragment,e),i=!1},d(e){e&&k(a),_(t,e)}}}function qe(l){let n,a,t,i,e=[],r=new Map,s,m;n=new j.BoxGeometry({props:{args:[C,C,C]}}),t=new j.MeshStandardMaterial({props:{roughness:0,metalness:.2}});let h=N({length:P});const b=f=>f[2];for(let f=0;f<h.length;f+=1){let o=U(l,h,f),v=b(o);r.set(v,e[f]=Y(v,o))}return{c(){c(n.$$.fragment),a=w(),c(t.$$.fragment),i=w();for(let f=0;f<e.length;f+=1)e[f].c();s=B()},l(f){g(n.$$.fragment,f),a=x(f),g(t.$$.fragment,f),i=x(f);for(let o=0;o<e.length;o+=1)e[o].l(f);s=B()},m(f,o){p(n,f,o),y(f,a,o),p(t,f,o),y(f,i,o);for(let v=0;v<e.length;v+=1)e[v]&&e[v].m(f,o);y(f,s,o),m=!0},p(f,o){o&0&&(h=N({length:P}),F(),e=Se(e,o,b,1,f,h,r,s.parentNode,Ge,Y,s,U),J())},i(f){if(!m){$(n.$$.fragment,f),$(t.$$.fragment,f);for(let o=0;o<h.length;o+=1)$(e[o]);m=!0}},o(f){u(n.$$.fragment,f),u(t.$$.fragment,f);for(let o=0;o<e.length;o+=1)u(e[o]);m=!1},d(f){f&&(k(a),k(i),k(s)),_(n,f),_(t,f);for(let o=0;o<e.length;o+=1)e[o].d(f)}}}function Ee(l){let n,a;return n=new je({props:{limit:P,$$slots:{default:[qe]},$$scope:{ctx:l}}}),{c(){c(n.$$.fragment)},l(t){g(n.$$.fragment,t)},m(t,i){p(n,t,i),a=!0},p(t,i){const e={};i&8&&(e.$$scope={dirty:i,ctx:t}),n.$set(e)},i(t){a||($(n.$$.fragment,t),a=!0)},o(t){u(n.$$.fragment,t),a=!1},d(t){_(n,t)}}}function Ke(l){let n,a;return n=new j.Group({props:{position:[0,1.7,0],$$slots:{default:[Ee]},$$scope:{ctx:l}}}),{c(){c(n.$$.fragment)},l(t){g(n.$$.fragment,t)},m(t,i){p(n,t,i),a=!0},p(t,[i]){const e={};i&8&&(e.$$scope={dirty:i,ctx:t}),n.$set(e)},i(t){a||($(n.$$.fragment,t),a=!0)},o(t){u(n.$$.fragment,t),a=!1},d(t){_(n,t)}}}const C=.02,P=100;class Oe extends M{constructor(n){super(),H(this,n,null,Ke,G,{})}}function Qe(l,n,a){const t=l.slice();return t[2]=n[a],t[4]=a,t}function Z(l){let n,a,t=N({length:25}),i=[];for(let e=0;e<t.length;e+=1)i[e]=Ue(Qe(l,t,e));return{c(){for(let e=0;e<i.length;e+=1)i[e].c();n=B()},l(e){for(let r=0;r<i.length;r+=1)i[r].l(e);n=B()},m(e,r){for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(e,r);y(e,n,r),a=!0},i(e){if(!a){for(let r=0;r<t.length;r+=1)$(i[r]);a=!0}},o(e){i=i.filter(Boolean);for(let r=0;r<i.length;r+=1)u(i[r]);a=!1},d(e){e&&k(n),ge(i,e)}}}function Ue(l){let n,a,t,i;return n=new Q({props:{jointIndex:l[4],hand:"left"}}),t=new Q({props:{jointIndex:l[4],hand:"right"}}),{c(){c(n.$$.fragment),a=w(),c(t.$$.fragment)},l(e){g(n.$$.fragment,e),a=x(e),g(t.$$.fragment,e)},m(e,r){p(n,e,r),y(e,a,r),p(t,e,r),i=!0},p:W,i(e){i||($(n.$$.fragment,e),$(t.$$.fragment,e),i=!0)},o(e){u(n.$$.fragment,e),u(t.$$.fragment,e),i=!1},d(e){e&&k(a),_(n,e),_(t,e)}}}function Ye(l){let n,a,t,i;n=new we({});let e=l[0]&&Z(l);return{c(){c(n.$$.fragment),a=w(),e&&e.c(),t=B()},l(r){g(n.$$.fragment,r),a=x(r),e&&e.l(r),t=B()},m(r,s){p(n,r,s),y(r,a,s),e&&e.m(r,s),y(r,t,s),i=!0},p(r,s){r[0]?e?s&1&&$(e,1):(e=Z(r),e.c(),$(e,1),e.m(t.parentNode,t)):e&&(F(),u(e,1,1,()=>{e=null}),J())},i(r){i||($(n.$$.fragment,r),$(e),i=!0)},o(r){u(n.$$.fragment,r),u(e),i=!1},d(r){r&&(k(a),k(t)),_(n,r),e&&e.d(r)}}}function Ze(l){let n,a,t,i,e,r,s,m,h,b;return n=new ke({props:{$$slots:{default:[Ye]},$$scope:{ctx:l}}}),t=new Oe({}),e=new j.AmbientLight({props:{intensity:.5}}),s=new j.SpotLight({props:{position:[1,8,1],angle:.3,penumbra:1,intensity:1,castShadow:!0}}),h=new We({props:{range:50,strength:1e-6,position:[0,1.7,0]}}),{c(){c(n.$$.fragment),a=w(),c(t.$$.fragment),i=w(),c(e.$$.fragment),r=w(),c(s.$$.fragment),m=w(),c(h.$$.fragment)},l(f){g(n.$$.fragment,f),a=x(f),g(t.$$.fragment,f),i=x(f),g(e.$$.fragment,f),r=x(f),g(s.$$.fragment,f),m=x(f),g(h.$$.fragment,f)},m(f,o){p(n,f,o),y(f,a,o),p(t,f,o),y(f,i,o),p(e,f,o),y(f,r,o),p(s,f,o),y(f,m,o),p(h,f,o),b=!0},p(f,[o]){const v={};o&33&&(v.$$scope={dirty:o,ctx:f}),n.$set(v)},i(f){b||($(n.$$.fragment,f),$(t.$$.fragment,f),$(e.$$.fragment,f),$(s.$$.fragment,f),$(h.$$.fragment,f),b=!0)},o(f){u(n.$$.fragment,f),u(t.$$.fragment,f),u(e.$$.fragment,f),u(s.$$.fragment,f),u(h.$$.fragment,f),b=!1},d(f){f&&(k(a),k(i),k(r),k(m)),_(n,f),_(t,f),_(e,f),_(s,f),_(h,f)}}}function et(l,n,a){let t;const{isHandTracking:i}=Te();return ee(l,i,e=>a(0,t=e)),[t,i]}class tt extends M{constructor(n){super(),H(this,n,et,Ze,G,{})}}function nt(l){let n,a;return n=new Re({}),{c(){c(n.$$.fragment)},l(t){g(n.$$.fragment,t)},m(t,i){p(n,t,i),a=!0},i(t){a||($(n.$$.fragment,t),a=!0)},o(t){u(n.$$.fragment,t),a=!1},d(t){_(n,t)}}}function rt(l){let n=localStorage.getItem("debug"),a,t,i,e=n&&nt();return t=new tt({}),{c(){e&&e.c(),a=w(),c(t.$$.fragment)},l(r){e&&e.l(r),a=x(r),g(t.$$.fragment,r)},m(r,s){e&&e.m(r,s),y(r,a,s),p(t,r,s),i=!0},p:W,i(r){i||($(e),$(t.$$.fragment,r),i=!0)},o(r){u(e),u(t.$$.fragment,r),i=!1},d(r){r&&k(a),e&&e.d(r),_(t,r)}}}function at(l){let n,a;return n=new Ce({props:{gravity:[0,0,0],$$slots:{default:[rt]},$$scope:{ctx:l}}}),{c(){c(n.$$.fragment)},l(t){g(n.$$.fragment,t)},m(t,i){p(n,t,i),a=!0},p(t,i){const e={};i&1&&(e.$$scope={dirty:i,ctx:t}),n.$set(e)},i(t){a||($(n.$$.fragment,t),a=!0)},o(t){u(n.$$.fragment,t),a=!1},d(t){_(n,t)}}}function it(l){let n,a,t,i;return n=new xe({props:{$$slots:{default:[at]},$$scope:{ctx:l}}}),t=new ve({}),{c(){c(n.$$.fragment),a=w(),c(t.$$.fragment)},l(e){g(n.$$.fragment,e),a=x(e),g(t.$$.fragment,e)},m(e,r){p(n,e,r),y(e,a,r),p(t,e,r),i=!0},p(e,[r]){const s={};r&1&&(s.$$scope={dirty:r,ctx:e}),n.$set(s)},i(e){i||($(n.$$.fragment,e),$(t.$$.fragment,e),i=!0)},o(e){u(n.$$.fragment,e),u(t.$$.fragment,e),i=!1},d(e){e&&k(a),_(n,e),_(t,e)}}}class ct extends M{constructor(n){super(),H(this,n,null,it,G,{})}}export{ct as component};
